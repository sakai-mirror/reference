/*! morpheus-master-grunt - v0.0.2 - 2014-12-17 This file is compiled */function closeDrawer(){jQuery("#selectSite div").hide(),jQuery("#selectSite").slideUp("fast"),removeDHTMLMask(),jQuery("#otherSiteTools").remove(),jQuery(".selectedTab").unbind("click"),jQuery(".moreSitesLink").unbind("keydown"),jQuery(".more-tab a").focus()}function createDHTMLMask(a){jQuery("body").append('<div id="portalMask">&nbsp;</div>'),jQuery("#portalMask").css("height",browserSafeDocHeight()).css({width:"100%","z-index":1e3,top:0,left:0}).bind("click",function(){return a(),!1}),jQuery("#portalMask").bgiframe()}function removeDHTMLMask(){jQuery("#portalMask").remove()}function keep_session_alive(){dismiss_session_alert(),jQuery.get(timeoutPortalPath)}function fetch_timeout_dialog(){jQuery.ajax({url:"/portal/timeout?auto=true",cache:!0,dataType:"text",success:function(a){timeoutDialogFragment=a},error:function(){timeoutDialogEnabled=!1}})}function show_timeout_alert(a){if(timeoutDialogEnabled)if(jQuery("#portalMask").get(0)||(createDHTMLMask(dismiss_session_alert),jQuery("#portalMask").css("z-index",1e4)),jQuery("#timeout_alert_body").get(0))jQuery("#timeout_alert_body span").html(a),jQuery("#timeout_alert_body span").css("top",f_scrollTop()+100+"px");else{var b=timeoutDialogFragment.replace("{0}",a);jQuery("body").append(b)}}function portalMaximizeTool(){(portal.toggle.sitenav||portal.toggle.tools)&&portal.toggle.allowauto&&sakaiMinimizeNavigation()}function updatePresence(){jQuery.ajax({url:sakaiPresenceFragment,cache:!1,success:function(a){var b=a.indexOf("<ul");if(1>b)return $("#presenceCount").html(" "),$("#presenceCount").removeClass("present").addClass("empty"),void location.reload();a=a.substr(b);for(var c=a,d="<li",e=0,f=0;f<c.length;f++)d==c.substr(f,d.length)&&e++;e>1?($("#presenceCount").html(e+""),$("#presenceCount").removeClass("empty").addClass("present")):1==e?($("#presenceCount").html(e+""),$("#presenceCount").removeClass("present").addClass("empty")):($("#presenceCount").html(" "),$("#presenceCount").removeClass("present").addClass("empty")),$("#presenceIframe").html(a);var g=$(".nav-selected .icon-sakai-chat").attr("href");$("#presenceIframe .presenceList li.inChat span").wrap('<a href="'+g+'"></a>'),sakaiLastPresenceTimeOut=setTimeout("updatePresence()",3e4)},error:function(){sakaiLastPresenceTimeOut=setTimeout("updatePresence()",6e4)}})}function f_scrollTop(){return f_filterResults(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)}function f_filterResults(a,b,c){var d=a?a:0;return b&&(!d||d>b)&&(d=b),c&&(!d||d>c)?c:d}function showToolMenu(a,b){a.preventDefault();var c=$(a.target),d=c.attr("id"),e=d.replace(/!/g,"\\!").replace(/~/g,"\\~");if($(".toolMenus").removeClass("toolMenusActive"),$("."+e).length)$("#otherSiteTools").remove();else{$("#otherSiteTools").remove();var f='<ul id="otherSiteTools" class="'+d+'" role="menu">',g="/direct/site/"+d+"/pages.json";scroll(0,0);var h=c.offset(),i=parseInt($("#maxToolsInt").text()),j=$("#maxToolsAnchor").text(),k='<li class="otherSiteTool"><span><a role="menuitem" href="'+portal.portalPath+"/site/"+d+'" title="'+j+'"><span class="toolMenuIcon icon-sakai-see-all-tools"> </span>'+j+"</a></span></li>";jQuery.getJSON(g,function(a){$.each(a,function(a,b){i>=a&&(b.toolpopup?f=f+'<li class="otherSiteTool"><span><a role="menuitem"  href="'+b.tools[0].url+'?sakai.popup=yes" title="'+b.title+'" onclick="window.open(\''+b.toolpopupurl+'\');"><span class="toolMenuIcon icon-'+b.tools[0].toolId.replace(/\./gi,"-")+'"> </span>'+b.title+"</a></span></li>":1===b.tools.length&&(f=f+'<li class="otherSiteTool"><span><a role="menuitem"  href="'+b.tools[0].url+'" title="'+b.title+'"><span class="toolMenuIcon icon-'+b.tools[0].toolId.replace(/\./gi,"-")+'"> </span>'+b.title+"</a></span></li>"))}),a.length-1>i&&(f+=k),f+="</ul>",$("#portalOuterContainer").append(f),$("#otherSiteTools").css({top:h.top+28,left:h.left-b}),$("#otherSiteTools li a:first").focus(),c.parent().find(".toolMenus").addClass("toolMenusActive"),$("#otherSiteTools").keydown(function(a){27==a.keyCode&&(a.preventDefault(),c.focus(),$(this).remove(),$("."+e).remove(),c.parent().find(".toolMenus").removeClass("toolMenusActive"))}),addArrowNavAndDisableTabNav($("#otherSiteTools"),function(){c.focus(),$("."+e).remove(),c.parent().find(".toolMenus").removeClass("toolMenusActive")})})}}function publishSite(a){{var b="/direct/site/"+a+"/edit";$.ajax({type:"POST",data:"published=true",url:b,success:function(){location.reload()}}).responseText}}function toggleShortUrlOutput(a,b,c){$(b).is(":checked")?$.ajax({url:"/direct/url/shorten?path="+encodeURI(a),success:function(a){$("."+c).val(a)}}):$("."+c).val(a)}function addArrowNavAndDisableTabNav(a,b){a.find("li a").attr("tabindex","-1").keydown(function(c){var d=$(c.target);if(40==c.keyCode){c.preventDefault();var e=d.parent().parent().next();void 0===e[0]?(a.slideUp("fast"),void 0!==b?b():d.parent().parent().parent().parent().children("a").focus()):e.find("a").focus()}else if(9==c.keyCode)a.slideUp("fast");else if(38==c.keyCode){c.preventDefault();var f=d.parent().parent().prev();void 0===f[0]?(a.slideUp("fast"),void 0!==b?b():d.parent().parent().parent().parent().children("a").focus()):f.find("a").focus()}})}function toggleToolsNav(){event.preventDefault(),$("body").toggleClass("nav-tools-displayed")}function toggleSitesNav(){event.preventDefault(),$("body").toggleClass("nav-sites-displayed")}function toggleMinimizeNav(){var a=$(this),b=$(".accessibility-btn-label",a);a.toggleClass("min max"),b.text()==a.data("title-expand")?(b.text(a.data("text-original")),a.attr("title",a.data("text-original")),a.attr("aria-pressed",!0)):(a.data("text-original",b.text()),b.text(a.data("title-expand")),a.attr("title",a.data("title-expand")),a.attr("aria-pressed",!1))}var dhtml_view_sites=function(){jQuery("#selectSite").appendTo("#linkNav").addClass("dhtml_more_tabs"),jQuery(".more-tab").position(),(dhtml_view_sites=function(){if("none"==jQuery("#selectSite").css("display")){jQuery("#selectSite div").show(),jQuery("#selectSite").slideDown("fast",function(){jQuery("#otherSitesCategorWrap").height()>300&&$("#otherSitesCategorWrap").height(300).css({overflow:"auto"}),jQuery("#txtSearch").focus()}),createDHTMLMask(dhtml_view_sites),jQuery(".selectedTab").bind("click",function(){return dhtml_view_sites(),!1}),jQuery("#selectSite a:first").focus(),jQuery("#selectSite a").keydown(function(a){(38==a.keyCode||27==a.keyCode)&&(a.preventDefault(),closeDrawer())}),$(".moreSitesLink").keydown(function(a){40==a.keyCode&&showToolMenu(a,0)});var a=$("#txtSearch");a.length?$(a[0]).keydown(function(a){9==a.keyCode&&a.shiftKey&&a.preventDefault()}):$("#allSites").keydown(function(a){9==a.keyCode&&a.shiftKey&&a.preventDefault()}),$("#otherSiteList > li:last").keydown(function(b){9!=b.keyCode||b.shiftKey||(b.preventDefault(),a.length?a[0].focus():$("#allSites").focus())})}else jQuery("#selectSite div").hide(),jQuery("#selectSite").slideUp("fast"),removeDHTMLMask(),jQuery("#otherSiteTools").remove(),jQuery(".selectedTab").unbind("click")})()},sessionId="current",sessionTimeOut,timeoutDialogEnabled=!1,timeoutDialogWarningTime,timeoutLoggedoutUrl,timeoutPortalPath;jQuery(document).ready(function(){portal.loggedIn&&portal.timeoutDialog&&setTimeout("setup_timeout_config();",6e4)});var setup_timeout_config=function(){timeoutDialogEnabled=portal.timeoutDialog.enabled,timeoutDialogWarningTime=portal.timeoutDialog.seconds,timeoutLoggedoutUrl=portal.loggedOutUrl,timeoutPortalPath=portal.portalPath,1==timeoutDialogEnabled&&(poll_session_data(),fetch_timeout_dialog())},poll_session_data=function(){jQuery.ajax({url:"/direct/session/"+sessionId+".json?auto=true&_="+(new Date).getTime(),dataType:"json",success:function(a){if(a.maxInactiveInterval=1e3*a.maxInactiveInterval,a.active&&null!=a.userId&&a.lastAccessedTime+a.maxInactiveInterval>a.currentTime){var b=a.lastAccessedTime+a.maxInactiveInterval-a.currentTime;1e3*timeoutDialogWarningTime>b?(min=Math.round(b/6e4),show_timeout_alert(min),clearTimeout(sessionTimeOut),sessionTimeOut=setTimeout("poll_session_data()",6e4)):(clearTimeout(sessionTimeOut),sessionTimeOut=setTimeout("poll_session_data()",b-1e3*timeoutDialogWarningTime))}else null==a.userId?location.href=timeoutLoggedoutUrl:sessionTimeOut=setTimeout("poll_session_data()",1e4)},error:function(){}})},dismiss_session_alert=function(){removeDHTMLMask(),jQuery("#timeout_alert_body").remove()},timeoutDialogFragment;jQuery(document).ready(function(){function a(){jQuery("#txtSearch").val(""),jQuery("#otherSiteList li").show(),jQuery(".otherSitesCategorList li").show(),jQuery("#otherSitesCategorWrap h4").show(),jQuery("#noSearchResults").fadeOut(),jQuery("#imgSearch").fadeOut(),jQuery("#txtSearch").focus()}1===$("#eid").length&&$("#eid").focus(),$(".more-tab a").keydown(function(a){return 40==a.keyCode||38==a.keyCode||27==a.keyCode?(a.preventDefault(),dhtml_view_sites()):void 0}),$(".toolMenus").click(function(a){showToolMenu(a,173)});var b=portal.siteTitle;b&&(portal.shortDescription&&(b=b+" ("+portal.shortDescription+")"),$(".portletTitle h2").prepend('<span class="siteTitle">'+b+":</span> ")),jQuery("#imgSearch").click(function(){a()}),jQuery("#txtSearch").keyup(function(b){27==b.keyCode&&a(),jQuery("#txtSearch").val().length>0&&(jQuery("#otherSiteList li, .otherSitesCategorList li").hide(),jQuery("#otherSitesCategorWrap h4").hide(),jQuery("#otherSiteList li a span.fullTitle:Contains('"+jQuery("#txtSearch").val()+"')").parent("a").parent("li").show(),jQuery(".otherSitesCategorList li a span.fullTitle:Contains('"+jQuery("#txtSearch").val()+"')").parent("a").parent("li").show().closest("ul").prev("h4").show(),jQuery("#imgSearch").fadeIn("slow")),0==jQuery("#txtSearch").val().length&&a(),jQuery("#otherSiteList li:visible").length<1&&jQuery(".otherSitesCategorList li:visible").length<1&&(jQuery(".norecords").remove(),jQuery("#otherSiteSearch #noSearchResults").fadeIn("slow"))}),jQuery.expr[":"].Contains=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},$("#presenceToggle").click(function(a){a.preventDefault(),$("#presenceArea").toggle()}),$(".trayPopupClose").click(function(a){a.preventDefault(),$(this).closest(".trayPopup").hide()}),jQuery("a.tool-directurl").length&&jQuery("a.tool-directurl").cluetip({local:!0,arrows:!0,cluetipClass:"jtip",sticky:!0,cursor:"pointer",activation:"click",closePosition:"title",closeText:'<img src="/library/image/silk/cross.png" alt="close">'}),jQuery("#toggleSubsitesLink").click(function(){var a=$(this);if("block"==$("#subSites").css("display"))$("#subSites").hide();else{var b=a.position();$("#subSites").css({position:"absolute",display:"block",left:b.left+a.width()+14+"px",top:b.top+"px"})}})});var setupSiteNav=function(){$("ul.subnav").each(function(){$(this).keydown(function(a){27==a.keyCode&&($(this).parent().children("a").focus(),$(this).slideUp("fast"))}),$(this).children("li:last").addClass("lastMenuItem")}),jQuery("ul.topnav > li").mouseleave(function(){$(this).find("ul").slideUp("fast")}),jQuery("#loginLinks ul.nav-submenu").mouseleave(function(){$(this).slideUp("fast")}),jQuery("#loginLinks span.drop").click(function(){$(this).prev("ul").slideDown("fast")}),fixTopNav=function(a){40==a.keyCode?(a.preventDefault(),jQuery("#selectSite").hide(),$(".nav-submenu").hide(),jQuery(this).parent().find(".drop").trigger("click",[!0])):27==a.keyCode&&($(this).parent().children("a").focus(),$(this).slideUp("fast"))},$(document).on?$(document).on("keydown",".topnav > li.nav-menu > a",fixTopNav):$(".topnav > li.nav-menu > a").live("keydown",fixTopNav),jQuery("ul.topnav > li").mouseleave(function(){$(this).find("ul").slideUp("fast")}),jQuery("ul.topnav li span.drop").click(function(a,b){jQuery(this).toggleClass("subclicked"),a.preventDefault();var c=$(a.target);if(c.parent("li").find("ul").length)c.parent("li").find("ul").slideDown("fast"),b&&c.parent().find("ul.subnav a:first").focus();else{var d='<ul class="nav-submenu subnav" role="menu" class="show">',e=c.attr("data"),f=parseInt($("#maxToolsInt").text()),g=$("#maxToolsAnchor").text(),h='<li class="submenuitem"><a role="menuitem" href="'+portal.portalPath+"/site/"+e+'" title="'+g+'"><span class="toolMenuIcon icon-sakai-see-all-tools"></span>'+g+"</a></li>",i="/direct/site/"+c.attr("data")+"/pages.json";jQuery.ajax({url:i,dataType:"json",success:function(a){$.each(a,function(a,b){f>=a&&(b.toolpopup?d=d+'<li class="submenuitem" ><span><a role="menuitem" href="'+b.tools[0].url+'?sakai.popup=yes" title="'+b.title+'" onclick="window.open(\''+b.toolpopupurl+'\');"><span class="toolMenuIcon icon-'+b.tools[0].toolId.replace(/\./gi,"-")+'"></span>'+b.title+"</a></span></li>":1===b.tools.length&&(d=d+'<li class="submenuitem" ><span><a role="menuitem" href="'+b.tools[0].url+'" title="'+b.title+'"><span class="toolMenuIcon icon-'+b.tools[0].toolId.replace(/\./gi,"-")+'"></span>'+b.title+"</a></span></li>"))}),a.length-1>f&&(d+=h),d+="</ul>",c.after(d),b&&c.parent().find("ul.subnav a:first").focus(),addArrowNavAndDisableTabNav($("ul.subnav"))},error:function(){}})}}).hover(function(){jQuery(this).addClass("subhover")},function(){jQuery(this).removeClass("subhover")})},setupToolToggle=function(a){$("#toggler").prependTo("#toolMenuWrap"),$("#toggler").css({display:"inline"}),$("#toggler").addClass(a),$("#toggleToolMenu").hover(function(){$(this).find("span").addClass("toggleToolMenuHover")},function(){$(this).find("span").removeClass("toggleToolMenuHover")}),$("#toggleToolMenu").click(function(){$("#toggleNormal").is(":visible")?(sakaiRestoreNavigation(),document.cookie="sakai_nav_minimized=false; path=/"):(sakaiMinimizeNavigation(),document.cookie="sakai_nav_minimized=true; path=/")})},setupSkipNav=function(){$("#skipNav a.internalSkip").click(function(){var a=$(this).attr("href");$(a).attr("tabindex","-1").focus()})};$(".js-toggle-sites-nav","#skipNav").on("click",toggleSitesNav),$(".js-toggle-tools-nav","#skipNav").on("click",toggleToolsNav),$(".js-toggle-nav").on("click",toggleMinimizeNav),WebFontConfig={google:{families:["Open+Sans:300italic,400italic,600italic,700italic,400,600,300,700:latin"]}},function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",a.type="text/javascript",a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}();